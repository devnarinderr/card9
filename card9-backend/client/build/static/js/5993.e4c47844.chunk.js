"use strict";(self.webpackChunk_minimal_material_kit_react=self.webpackChunk_minimal_material_kit_react||[]).push([[5993],{11402:(e,t,r)=>{r.d(t,{A:()=>n});var i=r(29246),l=r(53619);const s=new(r(41881).A),a=`${l.$}/api/auth/`,n={register:(e,t,r,l)=>i.A.post(`${a}register`,{firstName:e,lastName:t,email:r.toLowerCase(),password:l}).then((e=>e.data)).catch((e=>e.response)),googleLogin:()=>i.A.get(`${l.$}/api/oAuth/user`,{withCredentials:!0}).then((e=>e.data)).catch((e=>{console.log(e)})),emailVerify:e=>i.A.patch(`${a}emailVerification/${e}`).then((e=>e)).catch((e=>e)),login:(e,t)=>i.A.post(`${a}login`,{email:e.toLowerCase(),password:t}).then((e=>e.data)).catch((e=>e)),resetPassword:(e,t)=>i.A.patch(`${a}resetPassword/${t}`,{data:e}).then((e=>e)).catch((e=>e)),logout:()=>{localStorage.removeItem("user"),localStorage.removeItem("card"),s.remove("token")},updateProfile:(e,t)=>i.A.post(`${a}update-profil/${t}`,{data:e}).then((e=>e)),updateEmail:(e,t)=>i.A.post(`${a}update-email/${e}`,{id:e,email:t}).then((e=>e.data)),deleteUser:e=>i.A.delete(`${a}delete-user/${e}`,{id:e}).then((e=>e))}},23747:(e,t,r)=>{r.d(t,{A:()=>s});var i=r(29246);const l=`${r(53619).$}/api/admin/`,s={getAllUsers:()=>i.A.get(`${l}all-users`,{}).then((e=>e.data)).catch((e=>{console.error(e)})),updateUser:(e,t)=>i.A.patch(`${l}updateUser/${e}`,{values:t}).then((e=>e.data)).catch((e=>{console.error(e)})),renewCard:e=>i.A.patch(`${l}renew-card/${e}`).then((e=>e.data)).catch((e=>{console.error(e)})),getCardByUserId:e=>i.A.get(`${l}card-by-userId/${e}`).then((e=>e)).catch((e=>{console.error(e)}))}},32741:(e,t,r)=>{r.d(t,{E:()=>l,f:()=>i});const i=e=>{const t=new Date,r=new Date(e).getTime()-t.getTime();return Math.ceil(r/864e5)},l=e=>{if(e){const t=new Date(e),r=t.getFullYear();t.setFullYear(r);const i=t.getDate(),l=t.getMonth()+1,s=t.getFullYear();return`${i.toString().padStart(2,"0")}-${l.toString().padStart(2,"0")}-${s}`}return null}},34974:()=>{},35993:(e,t,r)=>{r.r(t),r.d(t,{default:()=>ie});var i=r(9950),l=r(97497),s=r(69780),a=r(9213),n=r(21671),o=r(7251),d=r(52346),c=r(83239),u=r(82053),h=r(35007),m=r(25333),g=r(70693),x=r(1320),p=r(15769),A=r(34075),j=r(6258),f=r(57988),v=r(27009),b=r(40759),w=r(40379),C=r(53256),S=r(75165),y=r(63464),k=r(79739),$=r(28170),T=r(6493),P=r(40033),N=r(60666),E=r(61467),I=r(12257),F=r(29925),D=r(2046),q=r(78822),L=r(66075),R=r(11402),B=r(44414);function O(e){let{open:t,setOpen:r,trigger:l,setTrigger:s}=e;const[a,n]=(0,i.useState)(!1),[o,d]=(0,i.useState)(!1),[c,u]=(0,i.useState)(null),[h,g]=(0,i.useState)(null),x=()=>{r(!1)},p=N.Ik().shape({firstName:N.Yj().min(2,"Too Short!").max(50,"Too Long!").required("First name required"),lastName:N.Yj().min(2,"Too Short!").max(50,"Too Long!").required("Last name required"),email:N.Yj().email("Email must be a valid email address").required("Email is required"),password:N.Yj().min(8,"Password Should Be More Then 8 Digits").required("Password is required")}),A=(0,E.Wx)({initialValues:{firstName:"",lastName:"",email:"",password:""},validationSchema:p,onSubmit:(e,t)=>{const{firstName:r,lastName:i,email:a,password:n}=e;try{R.A.register(r,i,a,n).then((e=>{400!==e.status?setTimeout((()=>{x(),A.resetForm(),s(!l),g("Account added")}),1e3):(d(!0),u(e.data.message),setTimeout((()=>{d(!1),u(null)}),3e3))}))}catch(o){}}}),{errors:j,touched:f,handleSubmit:v,getFieldProps:b}=A;return(0,B.jsx)("div",{children:(0,B.jsxs)(y.A,{open:t,onClose:x,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,B.jsx)(P.A,{id:"alert-dialog-title",children:"Add Account"}),(0,B.jsx)($.A,{children:(0,B.jsx)(T.A,{id:"alert-dialog-description",children:(0,B.jsxs)(E.QI,{value:A,children:[(0,B.jsx)(q.A,{open:o,setOpen:d,type:h?"success":"error",title:h?"Success":"Error",msg:h||c}),(0,B.jsx)(E.lV,{autoComplete:"off",noValidate:!0,onSubmit:v,children:(0,B.jsxs)(I.A,{spacing:3,children:[(0,B.jsxs)(I.A,{direction:{xs:"column",sm:"row"},spacing:2,children:[(0,B.jsx)(F.A,{fullWidth:!0,label:"First name",...b("firstName"),error:Boolean(f.firstName&&j.firstName),helperText:f.firstName&&j.firstName}),(0,B.jsx)(F.A,{fullWidth:!0,label:"Last name",...b("lastName"),error:Boolean(f.lastName&&j.lastName),helperText:f.lastName&&j.lastName})]}),(0,B.jsx)(F.A,{fullWidth:!0,autoComplete:"username",type:"email",label:"Email address",...b("email"),error:Boolean(f.email&&j.email),helperText:f.email&&j.email}),(0,B.jsx)(F.A,{fullWidth:!0,autoComplete:"current-password",type:a?"text":"password",label:"Password",...b("password"),InputProps:{endAdornment:(0,B.jsx)(D.A,{position:"end",children:(0,B.jsx)(m.A,{edge:"end",onClick:()=>n((e=>!e)),children:(0,B.jsx)(L.A,{icon:a?"eva:eye-fill":"eva:eye-off-fill"})})})},error:Boolean(f.password&&j.password),helperText:f.password&&j.password})]})})]})})}),(0,B.jsxs)(k.A,{children:[(0,B.jsx)(S.A,{onClick:x,children:"Close"}),(0,B.jsx)(S.A,{onClick:v,autoFocus:!0,children:"Create"})]})]})})}var U=r(25979),W=r(29277),_=r(41626),Y=r(16497),M=r(85815),V=r(23747);function z(e){let{open:t,setOpen:r,trigger:l,setTrigger:s,data:a}=e;const n=()=>{r(!1)},o=(0,E.Wx)({initialValues:{role:(null===a||void 0===a?void 0:a.role)||"user",limit:(null===a||void 0===a?void 0:a.limit)||1},validate:e=>{const t={};return e.role||(t.role="Role is required"),e.limit||(t.limit="Limit is required"),t},onSubmit:e=>{V.A.updateUser(null===a||void 0===a?void 0:a.id,e).then((e=>{console.log(e)})),o.resetForm(),s(!l),n()}});i.useEffect((()=>{if(a){let e={role:null===a||void 0===a?void 0:a.role,limit:null===a||void 0===a?void 0:a.limit};o.resetForm({values:e})}}),[a]);const{handleSubmit:d}=o;return(0,B.jsx)("div",{children:(0,B.jsxs)(y.A,{open:t,onClose:n,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,B.jsx)(P.A,{id:"alert-dialog-title",children:"Edit Record"}),(0,B.jsx)($.A,{children:(0,B.jsx)(T.A,{id:"alert-dialog-description",children:(0,B.jsxs)("form",{children:[(0,B.jsxs)(U.A,{component:"fieldset",children:[(0,B.jsx)(W.A,{component:"legend",children:"Role"}),(0,B.jsxs)(_.A,{name:"role",value:o.values.role,onChange:o.handleChange,style:{display:"flex",flexDirection:"row",marginBottom:5},children:[(0,B.jsx)(Y.A,{value:"admin",control:(0,B.jsx)(M.A,{color:"primary"}),label:"Admin"}),(0,B.jsx)(Y.A,{value:"user",control:(0,B.jsx)(M.A,{color:"primary"}),label:"User"})]}),o.errors.role&&(0,B.jsx)("div",{style:{color:"red"},children:o.errors.role})]}),(0,B.jsx)(F.A,{fullWidth:!0,autoComplete:"off",type:"number",label:"Limit",name:"limit",value:o.values.limit,onChange:o.handleChange,error:o.touched.limit&&Boolean(o.errors.limit),helperText:o.touched.limit&&o.errors.limit})]})})}),(0,B.jsxs)(k.A,{children:[(0,B.jsx)(S.A,{onClick:n,children:"Close"}),(0,B.jsx)(S.A,{onClick:d,autoFocus:!0,children:"Save"})]})]})})}var H=r(28095),Q=r(32741),X=(r(34974),r(71333));const Z=e=>{let{onClick:t,cardId:r,setTrigger:i,trigger:l}=e;const s=e=>{try{e&&V.A.renewCard(e).then((e=>{i(!l)}))}catch(t){console.log("Error: ",t)}};return(0,B.jsx)("button",{className:"customRenewButton",onClick:e=>{e.stopPropagation(),t&&t(e),r&&s(r)},children:(0,B.jsx)("div",{className:"bell",children:(0,B.jsx)(X.A,{})})})};var G=r(13564);function J(e,t,r){return t[r]<e[r]?-1:t[r]>e[r]?1:0}const K=[{id:"name",numeric:!1,disablePadding:!0,label:"Name"},{id:"email",numeric:!0,disablePadding:!1,label:"Email"},{id:"role",numeric:!0,disablePadding:!1,label:"Role"},{id:"limit",numeric:!0,disablePadding:!1,label:"Card Limit"},{id:"cards",numeric:!0,disablePadding:!1,label:"Total Cards"},{id:"expDate",numeric:!0,disablePadding:!1,label:"Expires on"},{id:"renew",numeric:!0,disablePadding:!1,label:"Renew"}];function ee(e){const{onSelectAllClick:t,order:r,orderBy:i,numSelected:l,rowCount:c,onRequestSort:u}=e;return(0,B.jsx)(s.A,{children:(0,B.jsx)(a.A,{children:K.map((e=>{return(0,B.jsx)(n.A,{align:e.numeric?"right":"left",padding:e.disablePadding?"none":"normal",sortDirection:i===e.id&&r,children:(0,B.jsxs)(o.A,{active:i===e.id,direction:i===e.id?r:"asc",onClick:(t=e.id,e=>{u(e,t)}),children:[e.label,i===e.id?(0,B.jsx)(d.A,{component:"span",sx:v.A,children:"desc"===r?"sorted descending":"sorted ascending"}):null]})},e.id);var t}))})})}function te(e){const{rowId:t,numSelected:r,setSelected:s,trigger:a,setTrigger:n,handleRowEdit:o}=e,[d,g]=i.useState(!1),[x,p]=i.useState(!1),A=(0,G.Zp)();return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(O,{open:d,setOpen:g,trigger:a,setTrigger:n}),(0,B.jsxs)(y.A,{open:x,onClose:()=>p(!1),maxWidth:"xs",fullWidth:!0,children:[(0,B.jsx)(P.A,{children:"Confirm user Deletion"}),(0,B.jsx)($.A,{children:(0,B.jsx)(T.A,{children:"Are you sure you want to delete this user?"})}),(0,B.jsxs)(k.A,{children:[(0,B.jsx)(S.A,{autoFocus:!0,onClick:()=>p(!1),children:"Cancel"}),(0,B.jsx)(H.A,{onClick:()=>{var e;(e=t)&&R.A.deleteUser(e).then((e=>{s([]),n(!a),p(!1)})).catch((e=>{}))},children:"Yes"})]})]}),(0,B.jsxs)(c.A,{sx:{pl:{sm:2},pr:{xs:1,sm:1},...r>0&&{bgcolor:e=>(0,l.X4)(e.palette.primary.main,e.palette.action.activatedOpacity)}},children:[(0,B.jsx)(u.A,{sx:{flex:"1 1 100%"},variant:"h6",id:"tableTitle",component:"div",children:"Users"}),r>0?(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(h.A,{title:"Modify",children:(0,B.jsx)(m.A,{onClick:()=>{var e;(e=t)&&A(`detail/${e}`)},children:(0,B.jsx)(b.A,{})})}),(0,B.jsx)(h.A,{title:"Edit",children:(0,B.jsx)(m.A,{onClick:()=>o(t),children:(0,B.jsx)(w.A,{})})}),(0,B.jsx)(h.A,{title:"Delete",children:(0,B.jsx)(m.A,{onClick:()=>p(!0),children:(0,B.jsx)(f.A,{})})})]}):(0,B.jsx)(h.A,{title:"Add Account",children:(0,B.jsx)(m.A,{onClick:()=>{g(!0)},children:(0,B.jsx)(C.A,{})})})]})]})}function re(e){let{dataList:t,trigger:r,setTrigger:l}=e;const[s,o]=i.useState("asc"),[c,u]=i.useState("calories"),[h,m]=i.useState([]),[f,v]=i.useState([]),[b,w]=i.useState(0),[C,S]=i.useState(5),[y,k]=i.useState(null),[$,T]=i.useState(!1),[P,N]=i.useState(null);i.useEffect((()=>{(null===t||void 0===t?void 0:t.length)>0&&E(t)}),[t]);const E=e=>{let t=[];e.forEach((e=>{var r,i,l,s,a,n,o,d,c,u;t.push((l=e.user.id,s=null===e||void 0===e||null===(r=e.card)||void 0===r?void 0:r.id,a=`${e.user.first_name} ${e.user.last_name}`,n=e.user.email,o=e.user.role,d=e.user.limit,c=e.user.totalCards,u=(0,Q.E)(null===e||void 0===e||null===(i=e.card)||void 0===i?void 0:i.expiredAt),{id:l,cardId:s,name:a,email:n,role:o,limit:d,cards:c,expDate:u}))})),v(t)},I=b>0?Math.max(0,(1+b)*C-f.length):0,F=i.useMemo((()=>function(e,t){const r=e.map(((e,t)=>[e,t]));return r.sort(((e,r)=>{const i=t(e[0],r[0]);return 0!==i?i:e[1]-r[1]})),r.map((e=>e[0]))}(f,function(e,t){return"desc"===e?(e,r)=>J(e,r,t):(e,r)=>-J(e,r,t)}(s,c)).slice(b*C,b*C+C)),[s,c,b,C,f]);return(0,B.jsxs)(d.A,{sx:{width:"100%"},children:[(0,B.jsx)(z,{open:$,setOpen:T,trigger:r,setTrigger:l,data:P}),(0,B.jsxs)(g.A,{sx:{width:"100%",mb:2},children:[(0,B.jsx)(te,{rowId:y,numSelected:h.length,setSelected:m,trigger:r,setTrigger:l,handleRowEdit:e=>{if(e&&f){T(!0);const t=f.find((t=>t.id===e));N(t||null)}}}),(0,B.jsx)(x.A,{sx:{maxHeight:400},children:(0,B.jsxs)(p.A,{sx:{minWidth:750},"aria-labelledby":"tableTitle",size:"small",stickyHeader:!0,"aria-label":"sticky table",children:[(0,B.jsx)(ee,{numSelected:h.length,order:s,orderBy:c,onSelectAllClick:e=>{if(e.target.checked){const e=f.map((e=>e.name));m(e)}else m([])},onRequestSort:(e,t)=>{o(c===t&&"asc"===s?"desc":"asc"),u(t)},rowCount:f.length}),(0,B.jsxs)(A.A,{children:[F&&F.map(((e,t)=>{var i;const s=(o=e.name,-1!==h.indexOf(o));var o;const d=`enhanced-table-checkbox-${t}`;return(0,B.jsxs)(a.A,{hover:!0,onClick:t=>((e,t,r)=>{let i=[];h.includes(t)?(i=[],k(null)):(i=[t],k(r)),m(i)})(0,e.name,e.id),role:"checkbox","aria-checked":s,tabIndex:-1,selected:s,sx:{cursor:"pointer"},children:[(0,B.jsx)(n.A,{component:"th",id:d,scope:"row",padding:"none",children:e.name}),(0,B.jsx)(n.A,{align:"right",children:e.email}),(0,B.jsx)(n.A,{align:"right",children:e.role}),(0,B.jsx)(n.A,{align:"right",children:e.limit}),(0,B.jsx)(n.A,{align:"right",children:e.cards}),(0,B.jsx)(n.A,{align:"right",children:null!==(i=e.expDate)&&void 0!==i?i:"-"}),(0,B.jsx)(n.A,{align:"right",children:(0,B.jsx)(Z,{cardId:e.cardId,setTrigger:l,trigger:r})})]},e.id)})),I>0&&(0,B.jsx)(a.A,{style:{height:33*I},children:(0,B.jsx)(n.A,{colSpan:6})})]})]})}),(0,B.jsx)(j.A,{rowsPerPageOptions:[5,10,25],component:"div",count:f.length,rowsPerPage:C,page:b,onPageChange:(e,t)=>{w(t)},onRowsPerPageChange:e=>{S(parseInt(e.target.value,10)),w(0)}})]})]})}const ie=()=>{const[e,t]=(0,i.useState)([]),[r,l]=(0,i.useState)(!1);return(0,i.useEffect)((async()=>{await V.A.getAllUsers().then((e=>{t(e.payload)})).catch((e=>{console.log("Error: ",e)}))}),[r]),(0,B.jsx)(re,{dataList:e,trigger:r,setTrigger:l})}},66075:(e,t,r)=>{r.d(t,{A:()=>c});var i=r(9950),l=r(11942),s=r.n(l),a=r(14650),n=r(52346),o=r(44414);const d=(0,i.forwardRef)(((e,t)=>{let{icon:r,sx:i,...l}=e;return(0,o.jsx)(n.A,{component:a.In,icon:r,sx:{...i},ref:t,...l})}));d.propTypes={icon:s().oneOfType([s().element,s().string]),sx:s().object};const c=d},78822:(e,t,r)=>{r.d(t,{A:()=>d});var i=r(3913),l=r(33174),s=r(25333),a=r(92743),n=r(66075),o=r(44414);function d(e){let{open:t,setOpen:r,title:d,msg:c,type:u="success"}=e;return(0,o.jsx)(i.A,{open:t,autoHideDuration:3e3,onClose:()=>r(!1),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:(0,o.jsxs)(l.A,{severity:u,action:(0,o.jsx)(s.A,{"aria-label":"close",color:"inherit",size:"small",onClick:()=>{r(!1)},children:(0,o.jsx)(n.A,{icon:"clarity:times-circle-line",width:22,height:22})}),sx:{textAlign:"left"},children:[(0,o.jsx)(a.A,{sx:{m:0},children:d}),c]})})}}}]);